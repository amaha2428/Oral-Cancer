{
  "openapi": "3.0.3",
  "info": {
    "title": "Oral Cancer Risk Prediction API",
    "description": "Production-ready REST API for predicting oral cancer risk using machine learning and pre-diagnosis self-reported symptoms and risk factors.\n\n---\n\n###  Features\n- **Versioned API endpoints** (`/api/v1/`)\n- **Rate limiting** (200/day, 50/hour)\n- **Input validation** with detailed error messages\n- **Request tracking** with unique IDs\n- **Health monitoring** endpoints\n- **Batch predictions** (up to 100 records)\n- **CORS enabled** for frontend integration\n\n---\n\n### ‚ö†Ô∏è Medical Disclaimer\nThis API is intended **for research, educational, and demonstration purposes only**.\n\nIt **does not provide a medical diagnosis**, and predictions generated by this system should **not be used as a substitute for professional medical advice, diagnosis, or treatment**.\n\nClinical decisions should always be made by qualified healthcare professionals using appropriate diagnostic procedures.\n\nThe model is trained on retrospective data and may not generalize to all populations or clinical settings.\n\n---\n\n###  Model Information\n- **Algorithm**: Random Forest Classifier\n- **Dataset Size**: 84,922 patient records\n- **Cross-Validation F1 Score**: 0.4965\n- **Features**: 16 pre-diagnosis risk factors and symptoms\n- **Framework**: scikit-learn\n\n---\n\n### üîó Links\n- **Live API**: http://oral-cancer.duckdns.org\n- **GitHub**: https://github.com/amaha2428/Oral-Cancer/\n- **Contact**: amahagodspower@gmail.com",
    "version": "1.0.0",
    "contact": {
      "name": "Godspower Ojoduene Amaha",
      "email": "amahagodspower@gmail.com"
    }
  },
  "servers": [
    {
      "url": "http://oral-cancer.duckdns.org",
      "description": "Production server"
    },
    {
      "url": "http://localhost:5555",
      "description": "Local development server"
    }
  ],
  "paths": {
    "/": {
      "get": {
        "summary": "API root",
        "description": "Get API overview and available endpoints",
        "tags": ["General"],
        "responses": {
          "200": {
            "description": "API information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "version": { "type": "string" },
                    "status": { "type": "string" },
                    "endpoints": { "type": "object" },
                    "timestamp": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health check",
        "description": "Check API and model health status",
        "tags": ["Monitoring"],
        "responses": {
          "200": {
            "description": "Health status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { 
                      "type": "string",
                      "example": "healthy",
                      "enum": ["healthy", "degraded", "unhealthy"]
                    },
                    "timestamp": { 
                      "type": "string",
                      "format": "date-time"
                    },
                    "version": { "type": "string" },
                    "components": {
                      "type": "object",
                      "properties": {
                        "model": { "type": "string" },
                        "api": { "type": "string" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/info": {
      "get": {
        "summary": "API information",
        "description": "Get comprehensive API information, rate limits, and documentation links",
        "tags": ["General"],
        "responses": {
          "200": {
            "description": "API details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiInfo"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/metadata": {
      "get": {
        "summary": "Model metadata",
        "description": "Retrieve information about the trained model, features used, and evaluation metrics",
        "tags": ["Model Information"],
        "responses": {
          "200": {
            "description": "Model metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MetadataResponse"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/model/info": {
      "get": {
        "summary": "Detailed model information",
        "description": "Get detailed model specifications including hyperparameters, performance metrics, and feature importance",
        "tags": ["Model Information"],
        "responses": {
          "200": {
            "description": "Detailed model information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ModelInfo"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/predict": {
      "post": {
        "summary": "Single patient prediction",
        "description": "Predict oral cancer risk for a single patient using pre-diagnosis features.\n\n**Rate Limit**: 20 requests per minute\n\n**Response includes**:\n- Prediction (0 or 1)\n- Confidence score\n- Class probabilities\n- Risk level (Low/Medium/High)\n- Request tracking ID",
        "tags": ["Predictions"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatientInput"
              },
              "examples": {
                "high_risk": {
                  "summary": "High risk patient",
                  "value": {
                    "age": 65,
                    "gender": 1,
                    "tobacco": 1,
                    "alcohol": 1,
                    "hpv": 1,
                    "betel_quid": 1,
                    "sun_exposure": 1,
                    "oral_hygiene": 0,
                    "diet_quality": 0,
                    "family_history": 1,
                    "immune_compromised": 1,
                    "oral_lesions": 1,
                    "bleeding": 1,
                    "swallowing": 1,
                    "mouth_patches": 1,
                    "region": 2
                  }
                },
                "low_risk": {
                  "summary": "Low risk patient",
                  "value": {
                    "age": 25,
                    "gender": 0,
                    "tobacco": 0,
                    "alcohol": 0,
                    "hpv": 0,
                    "betel_quid": 0,
                    "sun_exposure": 0,
                    "oral_hygiene": 1,
                    "diet_quality": 1,
                    "family_history": 0,
                    "immune_compromised": 0,
                    "oral_lesions": 0,
                    "bleeding": 0,
                    "swallowing": 0,
                    "mouth_patches": 0,
                    "region": 0
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Prediction successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PredictionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input or validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RateLimitError"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "503": {
            "description": "Model unavailable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/predict/batch": {
      "post": {
        "summary": "Batch patient predictions",
        "description": "Predict oral cancer risk for multiple patients in a single request.\n\n**Rate Limit**: 10 requests per minute\n\n**Limitations**:\n- Maximum 100 records per batch\n- All records must pass validation before processing\n\n**Response includes**:\n- Predictions for all records\n- Individual confidence scores\n- Risk levels for each patient\n- Request tracking ID",
        "tags": ["Predictions"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "maxItems": 100,
                "items": {
                  "$ref": "#/components/schemas/PatientInput"
                }
              },
              "examples": {
                "two_patients": {
                  "summary": "Two patient records",
                  "value": [
                    {
                      "age": 45,
                      "gender": 1,
                      "tobacco": 1,
                      "alcohol": 1,
                      "hpv": 0,
                      "betel_quid": 0,
                      "sun_exposure": 1,
                      "oral_hygiene": 0,
                      "diet_quality": 0,
                      "family_history": 0,
                      "immune_compromised": 0,
                      "oral_lesions": 1,
                      "bleeding": 0,
                      "swallowing": 0,
                      "mouth_patches": 0,
                      "region": 1
                    },
                    {
                      "age": 30,
                      "gender": 0,
                      "tobacco": 0,
                      "alcohol": 0,
                      "hpv": 0,
                      "betel_quid": 0,
                      "sun_exposure": 0,
                      "oral_hygiene": 1,
                      "diet_quality": 1,
                      "family_history": 0,
                      "immune_compromised": 0,
                      "oral_lesions": 0,
                      "bleeding": 0,
                      "swallowing": 0,
                      "mouth_patches": 0,
                      "region": 0
                    }
                  ]
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch prediction successful",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchPredictionResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input or validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchValidationError"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RateLimitError"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "503": {
            "description": "Model unavailable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "PatientInput": {
        "type": "object",
        "required": [
          "age", "gender", "tobacco", "alcohol", "hpv", "betel_quid",
          "sun_exposure", "oral_hygiene", "diet_quality",
          "family_history", "immune_compromised",
          "oral_lesions", "bleeding", "swallowing", "mouth_patches",
          "region"
        ],
        "properties": {
          "age": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 120,
            "description": "Patient age in years",
            "example": 45
          },
          "gender": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "0 = Female, 1 = Male",
            "example": 1
          },
          "tobacco": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Tobacco usage (0 = No, 1 = Yes)",
            "example": 1
          },
          "alcohol": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Alcohol consumption (0 = No, 1 = Yes)",
            "example": 1
          },
          "hpv": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "HPV infection status (0 = No, 1 = Yes)",
            "example": 0
          },
          "betel_quid": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Betel quid chewing (0 = No, 1 = Yes)",
            "example": 0
          },
          "sun_exposure": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Sun exposure (0 = No, 1 = Yes)",
            "example": 1
          },
          "oral_hygiene": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Oral hygiene status (0 = Poor, 1 = Good)",
            "example": 0
          },
          "diet_quality": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Diet quality (0 = Poor, 1 = Good)",
            "example": 0
          },
          "family_history": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Family history of oral cancer (0 = No, 1 = Yes)",
            "example": 0
          },
          "immune_compromised": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Immunocompromised status (0 = No, 1 = Yes)",
            "example": 0
          },
          "oral_lesions": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Presence of oral lesions (0 = No, 1 = Yes)",
            "example": 1
          },
          "bleeding": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Oral bleeding (0 = No, 1 = Yes)",
            "example": 0
          },
          "swallowing": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Difficulty swallowing (0 = No, 1 = Yes)",
            "example": 0
          },
          "mouth_patches": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 1,
            "description": "Mouth patches (0 = No, 1 = Yes)",
            "example": 0
          },
          "region": { 
            "type": "integer",
            "minimum": 0,
            "maximum": 10,
            "description": "Patient region code (0-10)",
            "example": 1
          }
        }
      },
      "PredictionResponse": {
        "type": "object",
        "properties": {
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique request identifier",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "prediction": {
            "type": "integer",
            "description": "Prediction result (0 = No Cancer, 1 = Cancer)",
            "example": 0,
            "enum": [0, 1]
          },
          "prediction_label": {
            "type": "string",
            "description": "Human-readable prediction label",
            "example": "No Oral Cancer",
            "enum": ["No Oral Cancer", "Oral Cancer"]
          },
          "confidence": {
            "type": "number",
            "format": "float",
            "description": "Confidence score for the prediction",
            "example": 0.8124,
            "minimum": 0,
            "maximum": 1
          },
          "class_probabilities": {
            "type": "object",
            "description": "Probability distribution across classes",
            "properties": {
              "no_cancer": { 
                "type": "number",
                "example": 0.8124
              },
              "oral_cancer": { 
                "type": "number",
                "example": 0.1876
              }
            }
          },
          "risk_level": {
            "type": "string",
            "description": "Risk assessment level",
            "example": "Low",
            "enum": ["Low", "Medium", "High"]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Prediction timestamp (UTC)",
            "example": "2024-01-15T10:30:00.000000"
          },
          "disclaimer": {
            "type": "string",
            "description": "Medical disclaimer",
            "example": "This is a risk prediction, not a diagnosis. Consult a healthcare professional."
          }
        }
      },
      "BatchPredictionResponse": {
        "type": "object",
        "properties": {
          "request_id": {
            "type": "string",
            "format": "uuid",
            "description": "Unique request identifier"
          },
          "num_records": {
            "type": "integer",
            "description": "Number of records processed",
            "example": 2
          },
          "results": {
            "type": "array",
            "description": "Prediction results for each record",
            "items": {
              "type": "object",
              "properties": {
                "record_index": {
                  "type": "integer",
                  "description": "Index of the record in the input array",
                  "example": 0
                },
                "prediction": { 
                  "type": "integer",
                  "example": 1,
                  "enum": [0, 1]
                },
                "prediction_label": {
                  "type": "string",
                  "example": "Oral Cancer",
                  "enum": ["No Oral Cancer", "Oral Cancer"]
                },
                "confidence": {
                  "type": "number",
                  "example": 0.8245
                },
                "class_probabilities": {
                  "type": "object",
                  "properties": {
                    "no_cancer": { "type": "number", "example": 0.1755 },
                    "oral_cancer": { "type": "number", "example": 0.8245 }
                  }
                },
                "risk_level": {
                  "type": "string",
                  "example": "High",
                  "enum": ["Low", "Medium", "High"]
                }
              }
            }
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "disclaimer": {
            "type": "string",
            "example": "These are risk predictions, not diagnoses. Consult healthcare professionals."
          }
        }
      },
      "MetadataResponse": {
        "type": "object",
        "properties": {
          "model_type": { 
            "type": "string",
            "example": "RandomForestClassifier"
          },
          "task": { 
            "type": "string",
            "example": "Binary classification (Oral Cancer Prediction)"
          },
          "features_used": {
            "type": "array",
            "items": { "type": "string" },
            "example": ["age", "gender", "tobacco", "alcohol", "hpv"]
          },
          "feature_count": {
            "type": "integer",
            "example": 16
          },
          "target": { 
            "type": "string",
            "example": "diagnosis"
          },
          "target_labels": {
            "type": "object",
            "properties": {
              "0": { "type": "string", "example": "No Oral Cancer" },
              "1": { "type": "string", "example": "Oral Cancer" }
            }
          },
          "evaluation_metric": { 
            "type": "string",
            "example": "F1 Score"
          },
          "cv_f1_score": { 
            "type": "number",
            "example": 0.4965
          },
          "dataset_size": { 
            "type": "integer",
            "example": 84922
          },
          "model_version": { 
            "type": "string",
            "example": "1.0.0"
          },
          "trained_on": {
            "type": "string",
            "example": "Pre-diagnosis self-reported symptoms and risk factors"
          },
          "training_date": {
            "type": "string",
            "example": "2024-01-15"
          },
          "framework": {
            "type": "string",
            "example": "scikit-learn"
          }
        }
      },
      "ModelInfo": {
        "type": "object",
        "properties": {
          "model_name": { "type": "string" },
          "version": { "type": "string" },
          "trained_date": { "type": "string" },
          "framework": { "type": "string" },
          "algorithm": { "type": "string" },
          "performance": {
            "type": "object",
            "properties": {
              "cv_f1_score": { "type": "number" },
              "cv_folds": { "type": "integer" },
              "train_test_split": { "type": "string" },
              "class_balance_technique": { "type": "string" }
            }
          },
          "hyperparameters": { "type": "object" },
          "input_features": { "type": "integer" },
          "output_classes": { "type": "integer" },
          "feature_importance_top_5": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "feature": { "type": "string" },
                "importance": { "type": "number" }
              }
            }
          }
        }
      },
      "ApiInfo": {
        "type": "object",
        "properties": {
          "api_name": { "type": "string" },
          "version": { "type": "string" },
          "description": { "type": "string" },
          "purpose": { "type": "string" },
          "disclaimer": { "type": "string" },
          "author": { "type": "string" },
          "contact": { "type": "string" },
          "documentation": { "type": "string" },
          "github": { "type": "string" },
          "rate_limits": {
            "type": "object",
            "properties": {
              "per_hour": { "type": "integer" },
              "per_day": { "type": "integer" }
            }
          },
          "endpoints": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "description": "Error message",
            "example": "Internal server error"
          },
          "details": {
            "type": "string",
            "description": "Detailed error information"
          },
          "request_id": {
            "type": "string",
            "description": "Request identifier for tracking"
          }
        }
      },
      "ValidationError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "Input validation failed"
          },
          "validation_errors": {
            "type": "array",
            "items": { "type": "string" },
            "example": ["age must be between 0 and 120", "tobacco must be between 0 and 1"]
          },
          "request_id": { "type": "string" }
        }
      },
      "BatchValidationError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "Validation failed for some records"
          },
          "validation_errors": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "record_index": { "type": "integer" },
                "errors": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          },
          "request_id": { "type": "string" }
        }
      },
      "RateLimitError": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string",
            "example": "Rate limit exceeded"
          },
          "message": {
            "type": "string",
            "example": "20 per 1 minute"
          },
          "status": {
            "type": "integer",
            "example": 429
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "General",
      "description": "General API information and endpoints"
    },
    {
      "name": "Monitoring",
      "description": "Health checks and monitoring endpoints"
    },
    {
      "name": "Model Information",
      "description": "Model metadata and specifications"
    },
    {
      "name": "Predictions",
      "description": "Prediction endpoints for single and batch requests"
    }
  ]
}